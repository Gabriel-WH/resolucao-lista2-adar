---
title: "Resolução Lista 02 de ADAR"
author: "Gabriel Welter Hartmann"
date: "09/01/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exercícios

1. Crie um vetor com os valores de $x = ( 3, \: 3.1, \: 3.2,  \:..., \: 6 )$.

```{r}
(x <- seq(from = 3, to = 6, by = 0.1))
```

- - -

2. Cire os seguintes vetores.

   a. $(0.1^3 \times 0.2^1, \: 0.1^6 \times 0.2^4, \: ..., \: 0.1^{36} \times \: 0.2^{34})$

```{r}
exp1 <- seq(from = 3, to = 36, by = 3)
exp2 <- seq(from = 1, to = 34, by = 3)
vetor_2a <- 0.1^(exp1) * 0.2^(exp2)
vetor_2a
```

   b. $\left(2, \: \frac{2^2}{2}, \: \frac{2^3}{3}, \: ..., \: \frac{2^{25}}{25} \right)$

```{r}
seq_aux <- seq(from = 1, to = 25, by = 1)
vetor_2b <- (2^(seq_aux))/seq_aux
vetor_2b
```

- - -

3. Reproduza a criação do vetor dias da semana (`dds`) mostrado abaixo.

```
domingo segunda terca quarta quinta sexta sabado
   1       2      3      4      5     6     7
```

```{r}
dds <- c(
         domingo = 1,
         segunda = 2,
         terca = 3,
         quarta = 4,
         quinta = 5,
         sexta = 6,
         sabado = 7
         )

dds
```

- - -

4. Interprete o resultado da seguinte operação:

```
dds_nums <- c(
  5L, 2L, 5L, 2L, 7L, 7L, 2L,
  6L, 6L, 3L, 7L, 1L, 2L, 2L,
  5L, 7L, 3L, 2L, 6L, 4L, 1L
)
names(dds)[dds_nums]
```

```{r}
dds_nums <- c(
  5L, 2L, 5L, 2L, 7L, 7L, 2L,
  6L, 6L, 3L, 7L, 1L, 2L, 2L,
  5L, 7L, 3L, 2L, 6L, 4L, 1L
)
names(dds)[dds_nums]
```
A linha de atribuição à `dds_nums` cria um vetor de inteiros (no qual eu não identifiquei uma sequência lógica) com um `range` igual ao comprimento de`dds`, assim a linha `names(dds)[dds_nums]` serve para exibir os nomes do vetor `dds` na posição apontada pelos elementos de `dds_nums`, e como cada posição do vetor `dds` é nomeada com o respectivo dia da semana, são exibidos os dias da semana de acordo com a sequência de `dds_nums`

- - -

5. a.Escreva o código necessário para determinar o vetor lógico indicando quais números são pares na sequência de valores 85, 79, 70, 6, 32, 8, 17, 93, 81, 76.

```{r}
vetor_5a <- c(85, 79, 70, 6, 32, 8, 17, 93, 81, 76)
vetor_par_5a <- (vetor_5a %% 2 == 0)
vetor_par_5a
```

b. Calcule o total de números ímpares.

```{r}
quant_impar <- sum(vetor_5a %%2 != 0)
quant_impar
```

- - -

6. Para um ano ser bissexto, ele deve ser:

- divisível por 4(a divisão é eata com resto igual a zero).

- não pode ser divisível por 100 (a divisão não é exata, ou seja, o resto é diferente de zero).

- pode ser que seja divisível por 4000: caso seja divisível por 400, a divisão deve ser exata, deixando oresto igual a zero.

Com os critérios definidos acima, construa o código para:

a. Verificar se os anos 1894, 1947, 1901, 1992, 1925, 2014, 1993, 1996, 1984, 1897, 2100, 2300 são bissextos.

```{r}
anos <- c(1894, 1947, 1901, 1992, 1925, 2014, 1993, 1996,            1984, 1897, 2100, 2300)

ano_bissexto <- (anos %% 4 == 0 & anos %% 100 != 0) | (anos %% 4 == 0 & anos %% 400 == 0 )

ano_bissexto
```

b. Mostre quais anos são bissextos.

```{r}
anos[ano_bissexto]
```

c. Usando o código para verificar se o ano é bissexto, gere um vetor nomeado `ndias` com o número de dias do ano para os anos do item (a).

```{r}
ndias <- ifelse(
                test = ano_bissexto,
                yes = 366,
                no = 365
                )
ndias
```

d. Program como obter o total de anos com 366 dias?

```{r}
tot_anos_bissexto <- sum(ano_bissexto)
tot_anos_bissexto

#ou

tot_anos_bissexto <- sum(ndias==366)
tot_anos_bissexto
```

- - -

7. Quais códigos para gerar os seguintes dados:

a. `[1] -30   0   5  10  15  20  30`

```{r}
vetor_7a <- c(
              -30,
              seq(from = 0, to = 20, by = 5),
              30
              )
vetor_7a
```

b. `[1] 1.0 0.8 0.6 0.4 0.2 0.0`

```{r}
vetor_7b <- seq(from = 1.0, to = 0.0, by = -0.2)
vetor_7b
```

c. 

```
[1] -3.1415927 -2.4434610 -1.7453293 -1.0471976 -0.3490659  0.3490659
[7]  1.0471976  1.7453293  2.4434610  3.1415927
```

```{r}
vetor_7c <- seq(from = -pi, to = pi, length.out = 10)
vetor_7c
```

d.

```
[1] -1 -1  0  0  0  1  1  1  1  2  2  2  2  2  3  3  3  3  3  3  4  4  4
[24]  4  4  4  4  5  5  5  5  5  5  5  5
```

```{r}
vetor_7d <- rep(x = -1:5, times = 2:8)
vetor_7d
```

e.

```
[1] 5 5 5 5 5 4 4 4 4 3 3 3 2 2 1 2 2 3 3 3 4 4 4 4 5 5 5 5 5
```

```{r}
vetor_7e <- rep(x = c(5:1,2:5), times = c(5:1,2:5))
vetor_7e
```

- - -

8. Usando o mesmo código para solução em todos os itens abaixo, obtenha as seguintes sequências usando os vetores fornecidos.

a. v3 = (11, 0.25, 7, 2)

```
[1] 1 2 3 4
```

Computando o vetor fornecido e atribuindo-o ao vetor da solução padrão.

```{r}
vetor_8 <- v3 <- c(11, 0.25, 7, 2)
```

Aplicando o código padrão.

```{r}
seq(from = 1, to = length(vetor_8), length.out = length(vetor_8))
```

b. v2 = (11, 0.25)

```
[1] 1 2
```

Computando o vetor fornecido e atribuindo-o ao vetor da solução padrão.

```{r}
vetor_8 <- v2 <- c(11, 0.25)
```

Aplicando o código padrão.

```{r}
seq(from = 1, to = length(vetor_8), length.out = length(vetor_8))
```

c. v1 = (11)

```
[1] 1
```

Computando o vetor fornecido e atribuindo-o ao vetor da solução padrão.

```{r}
vetor_8 <- v1 <- c(11)
```

Aplicando o código padrão.

```{r}
seq(from = 1, to = length(vetor_8), length.out = length(vetor_8))
```

d. v0 = ()

```
integer(0)
```

Computando o vetor fornecido e atribuindo-o ao vetor da solução padrão.

```{r}
vetor_8 <- v0 <- c()
```

Aplicando o código padrão.

```{r}
seq(from = 1, to = length(vetor_8), length.out = length(vetor_8))
```

- - -

9. Considere os seguintes dados horários de temperatura do ar $(T_{ar})$ registrados em duas estações meteorológicas, entre as 0 e 23 horas de um dado dia.

```{r}
tar_est1 <- c(
  14.92, 14.61, 14.32, 14.07, 13.84, 13.65, 13.56, 13.97, 15.08,
  16.5, 17.88, 19.08, 20.02, 20.66, 21.01, 21.05, 20.76, 20.05,
  18.77, 17.51, 16.67, 16.11, 15.66, 15.27
)
tar_est2 <- c(
  13.13, 13.01, 12.93, 12.87, 12.82, 12.81, 13.2, 14.22, 15.77,
  17.49, 19.2, 20.57, 21.49, 22.01, 22.03, 21.71, 20.84, 18.77,
  16.54, 15.13, 14.34, 13.81, 13.49, 13.28
)
```

> Dica: Faça um gráfico para visualizar as temperaturas das duas estações. Isso facilitará a solução.

Seguindo a dica dada:

```{r}
length(tar_est1)
length(tar_est2)

#verificando o tamanho dos vetores

horas <- seq(0, 23)

plot(
     x = horas,
     y = tar_est1,
     xlab = "Horas",
     ylab = "Temperatura do ar (ºC)",
     main = "Temperatura do ar",
     type = "b",
     lwd = 3,
     col = 2,
     ylim = range(c(tar_est1,tar_est2))
     )

lines(
      x = horas,
      y = tar_est2,
      col = "blue",
      lwd = 3,
      type = "b"
      )
```

a. Determine a média diária de $T_{ar}$ das duas estações arredondando para uma casa decimal. Salve a média de cada estação nas variáveis `tmed_est1` e `tmed_est2`.

```{r}
tmed_est1 <- round(x = mean(tar_est1), digits = 1)
tmed_est2 <- round(x = mean(tar_est2), digits = 1)
tmed_est1
tmed_est2
```

b. Utilizando as variáveis do item anterior, verifique usando comparação lógica, em qual estação o ambiente é mais quente?

```{r}
tmed_est1 == tmed_est2

#Os valores não são iguais

est_quente <- ifelse(
                     test = tmed_est1 > tmed_est2,
                     yes = "O ambiente da estação 1 é mais quente",
                     no = "O ambiente da estação 2 é mais quente"
                     )
est_quente
```

c. Obtenha a 3ª maior temperatura do dia em cada estação.

```{r}
maxtemp3_est1 <- sort(x = tar_est1, decreasing = TRUE)[3]
maxtemp3_est2 <- sort(x = tar_est2, decreasing = TRUE)[3]
maxtemp3_est1
maxtemp3_est2
```

d. Calcule a amplitude térmica diária ($ATD = T_{máx}-T_{min}$, onde $T_{máx}$: temperatura máxima diária e $T_{min}$: temperatura mínima diária) das estações 1 e 2, arredondando para uma casa decimal. Salve os resultados nas variáveis `atd_est1` e `atd_est2`.

```{r}
atd_est1 <- round(max(tar_est1)-min(tar_est1), digits = 1)
atd_est2 <- round(max(tar_est2)-min(tar_est2), digits = 1)
atd_est1
atd_est2
```

e. Qual o horário de ocorrência das temperaturas máximas e mínimas em cada estação? Salve os resultados nas variáveis `hmax_est{i}` e `hmin_est{i}`, com $i = 1, 2$.

```{r}
hmax_est1 <- horas[which(max(tar_est1) == tar_est1)]
hmax_est2 <- horas[which(max(tar_est2) == tar_est2)]
hmin_est1 <- horas[which(min(tar_est1) == tar_est1)]
hmin_est2 <- horas[which(min(tar_est2) == tar_est2)]
hmax_est1
hmax_est2
hmin_est1
hmin_est2
```

f. Quando `tar_est2` é maior que `tar_est1` qual a maior diferença absoluta de temperatura entre as duas estações?

```{r}
vetor_max_diff <- abs(tar_est2[which(tar_est2 > tar_est1)] - tar_est1[which(tar_est2 > tar_est1)])
max_diff <- max(vetor_max_diff)
max_diff
```

g. Qual a hora correspondente à ocorrência daquela maior diferença absoluta de temperatura obtida no item anterior?

```{r}
hora_max_diff <- horas[which(tar_est2 > tar_est1 & abs(tar_est2 - tar_est1) == max_diff)]
hora_max_diff
```

h. O horário do pôr do sol ser estimado a partir da $T_{ar}$. Para o período após o horário de ocorrência da T_{máx} determina-se em qual hora ocorre a maior queda de $T_{ar}$ em relação a hora anterior. Estime o horário do pôr do sol para as duas estações (`hps_est{i}`).

```{r}
tar_apos_tmax_est1 <- tar_est1
tar_apos_tmax_est1[1:hmax_est1] <- NA

diff_apos_tmax_est1 <- c(NA, diff(tar_apos_tmax_est1))
aux1 <- which(diff_apos_tmax_est1 == min(diff_apos_tmax_est1, na.rm = TRUE))
hps_est1 <- horas[aux1]
hps_est1

tar_apos_tmax_est2 <- tar_est2
tar_apos_tmax_est2[1:hmax_est2] <- NA

diff_apos_tmax_est2 <- c(NA, diff(tar_apos_tmax_est2))
aux2 <- which(diff_apos_tmax_est2 == min(diff_apos_tmax_est2, na.rm = TRUE))
hps_est2 <- horas[aux2]
hps_est2
```

i. Em quais horas as temperaturas das duas estações estão mais próximas uma da outra, ou seja com menos de 0,5°C de diferença ?

```{r}
horas_prox <- horas[which(abs(tar_est1 - tar_est2) < 0.5)]
horas_prox
```

j. Calcule a temperatura média diária usando os seguintes métodos para a estação 2.

$T_{med1} = \frac{T_{max}+T_{min}}{2}$, salvando em uma variável `tar_met1`.

$T_{med2}= \frac{T_{max}+T_{min}+T_{9}+2T_{21}}{5}$, salvando em uma variável `tar_met2`.

$T_{med3}=\frac{T_{7}+T_{14}+2T_{21}}{4}$, salvando em uma variável `tar_met3`.

```{r}
tar_met1 = (max(tar_est2)+min(tar_est2)) / 2
tar_met1

tar_met2 = (max(tar_est2) + min(tar_est2) + tar_est2[which(horas == 9)] + tar_est2[which(horas == 21)] * 2) / 5
tar_met2

tar_met3 = (tar_est2[which(horas == 7)] + tar_est2[which(horas == 14)] + tar_est2[which(horas == 9)] * 2) / 4
tar_met3
```

k. Compare este resultado com aqueles obtidos no item a. Qual é melhor?

```{r}
plot(
     x = horas,
     y = tar_est2,
     xlab = "Horas",
     ylab = "Temperatura do ar (ºC)",
     main = "Temperatura do ar - estação 2",
     type = "b",
     lwd = 3,
     col = "blue",
     ylim = range(tar_est2)
     )

abline(h = tmed_est2, col = 1, lwd = 3)

abline(h = tar_met1, col = 4, lwd = 2)
abline(h = tar_met2, col = 6, lwd = 2)
abline(h = tar_met3, col = 7, lwd = 2)
```

O melhor é `tmed_est2`, da questão 1, por levar em conta mais valores.

- - -

10. Calcule a temperatura do ar horária usando o **modelo de onda** para representação do ciclo diário da temperatura do ar, descrito pelas seguintes equações:

$$\left\{ \begin{matrix}
h_{T_{min}} \leq h \leq h_{T_{max}} , \; T_{calc} = \bar{T} - A\cos(arg) \\
demais \;\: horas, \; T_{calc} = \bar{T} + A\cos(arg)
\end{matrix}\right.$$

onde:

$$ \bar{T} = \left(\frac{T_{máx}+T_{min}}{2} \right)$$

e

$$ A =\left(\frac{T_{máx}-T_{min}}{2} \right)$$

O argumento do cosseno $(arg)$ é definido por:

$$\left\{ \begin{matrix}
h \le h_{T_{min}}, \; arg = \pi\left( \frac{h+10}{10+h_{T_{min}}} \right) \\
h_{T_{min}} \leq h < h_{T_{max}}, \; arg = \pi \left( \frac{h - h_{T_{min}}}{14 - h_{T_{min}}} \right) \\
h > h_{T_{max}}, \; arg = \pi \left( \frac{14-h}{10+h_{T_{min}}} \right)
\end{matrix} \right.$$

a. Aplique o método acima para a estação 1 e 2 substituindo os valores de $T_{max}$, $T_{min}$, $h_{T_{max}}$ e $h_{T_{min}}$, adequadamente.

```{r}
t_barra_est1 <- (max(tar_est1) + min(tar_est1)) / 2
a_upper_est1 <- (max(tar_est1) - min(tar_est1)) / 2

arg1_est1 <- pi*((horas[1:hmin_est1] + 10) / (10 + hmin_est1))

arg2_est1 <- pi*((horas[(hmin_est1+1):hmax_est1] - hmin_est1) / (14 - hmin_est1))

arg3_est1 <- pi*((14 - horas[(hmax_est1+1):length(horas)]) / (10 + hmin_est1))

tar_calc_est1 <- rep(x = NA, times = length(tar_est1)) #inicializa o vetor da temperatura calculada sem valor algum, mas com o mesmo tamanho de tar_est1

tar_calc_est1[1:hmin_est1] <- t_barra_est1 + a_upper_est1*cos(arg1_est1)
tar_calc_est1[(hmin_est1+1):hmax_est1] <- t_barra_est1 - a_upper_est1*cos(arg2_est1)
tar_calc_est1[(hmax_est1+1):length(tar_calc_est1)] <- t_barra_est1 + a_upper_est1*cos(arg3_est1)

t_barra_est2 <- (max(tar_est2) + min(tar_est2)) / 2
a_upper_est2 <- (max(tar_est2) - min(tar_est2)) / 2

arg1_est2 <- pi*((horas[1:hmin_est2] + 10) / (10 + hmin_est2))

arg2_est2 <- pi*((horas[(hmin_est2+1):hmax_est2] - hmin_est2) / (14 - hmin_est2))

arg3_est2 <- pi*((14 - horas[(hmax_est2+1):length(horas)]) / (10 + hmin_est2))

tar_calc_est2 <- rep(x = NA, times = length(tar_est2)) #inicializa o vetor da temperatura calculada sem valor algum, mas com o mesmo tamanho de tar_est2

tar_calc_est2[1:hmin_est2] <- t_barra_est2 + a_upper_est2*cos(arg1_est2)
tar_calc_est2[(hmin_est2+1):hmax_est2] <- t_barra_est2 - a_upper_est2*cos(arg2_est2)
tar_calc_est2[(hmax_est2+1):length(tar_calc_est2)] <- t_barra_est2 + a_upper_est2*cos(arg3_est2)
```

Gerando o gráfico da temperatura calculada(linha) em comparação com a observada(pontos):

```{r}
plot(
     x = horas,
     y = tar_est1,
     xlab = "Horas",
     ylab = "Temperatura do ar (ºC)",
     main = "Temperatura do ar - Comparação entre a temperatura calculada e a observada",
     type = "p",
     lwd = 2,
     col = 2,
     ylim = range(c(tar_est1,tar_est2))
     )

lines(
      x = horas,
      y = tar_est2,
      col = "blue",
      lwd = 2,
      type = "p"
      )

lines(
      x = horas,
      y = tar_calc_est1,
      col = 2,
      lwd = 2,
      type = "l"
      )

lines(
      x = horas,
      y = tar_calc_est2,
      col = "blue",
      lwd = 2,
      type = "l"
      )
```

b. Calcule o RMSE nos dois casos.

$$
RMSE = \sqrt{\frac{1}{n}\sum^{n}_{i=1}(T_{calc}-T_{obs})^2}
$$

```{r}
rmse_est1 <- sqrt(sum((tar_calc_est1 - tar_est1)^2) / length(tar_est1))

rmse_est1

rmse_est2 <- sqrt(sum((tar_calc_est2 - tar_est2)^2) / length(tar_est2))

rmse_est2
```

